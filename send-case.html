<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Send a Case | Wielgo Tech</title>

    <style>
      body {
        margin: 0;
        font-family: Arial, Helvetica, sans-serif;
        background: #dfe4df;
        color: #2c2c2c;
      }
      .wrap {
        max-width: 980px;
        margin: 0 auto;
        padding: 50px 24px;
      }
      .top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        flex-wrap: wrap;
        margin-bottom: 18px;
      }
      a.link {
        color: #7a6f60;
        text-decoration: none;
        border-bottom: 1px solid rgba(122, 111, 96, 0.35);
        padding-bottom: 2px;
      }
      h1 {
        margin: 0;
        letter-spacing: 0.5px;
      }
      .sub {
        margin: 8px 0 0;
        max-width: 780px;
        line-height: 1.6;
      }
      .card {
        margin-top: 22px;
        background: #f4efe8;
        padding: 22px;
        border-radius: 14px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 14px;
      }
      @media (min-width: 860px) {
        .grid.two {
          grid-template-columns: 1fr 1fr;
        }
      }
      label {
        font-size: 14px;
        color: #4a4a4a;
        display: block;
        margin-bottom: 6px;
      }
      input, select, textarea {
        width: 100%;
        padding: 12px 12px;
        border-radius: 12px;
        border: 1px solid rgba(122, 111, 96, 0.35);
        background: rgba(255, 255, 255, 0.6);
        outline: none;
        font-size: 16px;
        box-sizing: border-box;
      }
      textarea { min-height: 110px; resize: vertical; }
      .hint { font-size: 12px; color: #6b6257; margin-top: 6px; }
      .row {
        display: grid;
        grid-template-columns: 1fr;
        gap: 14px;
      }
      .actions {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-top: 14px;
      }
      button {
        appearance: none;
        border: 1px solid #7a6f60;
        background: #7a6f60;
        color: #fff;
        padding: 12px 18px;
        border-radius: 12px;
        cursor: pointer;
        font-size: 16px;
      }
      button.secondary {
        background: transparent;
        color: #7a6f60;
      }
      .note {
        margin-top: 12px;
        font-size: 12px;
        color: #6b6257;
        line-height: 1.5;
      }
      .success, .error {
        display: none;
        margin-top: 14px;
        padding: 12px 14px;
        border-radius: 12px;
        font-size: 14px;
      }
      .success { background: rgba(46, 125, 50, 0.12); border: 1px solid rgba(46, 125, 50, 0.25); }
      .error { background: rgba(198, 40, 40, 0.10); border: 1px solid rgba(198, 40, 40, 0.20); }
      footer { margin-top: 26px; font-size: 13px; color: #6b6257; }
      code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="top">
        <div>
          <h1>Send a Case</h1>
          <p class="sub">
            Prototype intake form for Wielgo Tech. (You’re testing privately right now — we’ll upgrade to secure storage before using publicly.)
          </p>
        </div>
        <div>
          <a class="link" href="./index.html">← Back to Home</a>
        </div>
      </div>

      <div class="card">
        <form id="caseForm">
          <div class="grid two">
            <div>
              <label for="doctorName">Doctor Name</label>
              <input id="doctorName" name="doctorName" placeholder="Dr. John Smith" required />
            </div>
            <div>
              <label for="officeName">Office / Practice</label>
              <input id="officeName" name="officeName" placeholder="Smith Dental" required />
            </div>

            <div>
              <label for="email">Email</label>
              <input id="email" name="email" type="email" placeholder="doctor@office.com" required />
            </div>
            <div>
              <label for="phone">Phone</label>
              <input id="phone" name="phone" placeholder="(555) 555-5555" />
            </div>

            <div>
              <label for="patientName">Patient Name (Prototype)</label>
              <input id="patientName" name="patientName" placeholder="Jane Doe" />
              <div class="hint">We’ll move this to a secure system before public launch.</div>
            </div>
            <div>
              <label for="dueDate">Due Date</label>
              <input id="dueDate" name="dueDate" type="date" />
            </div>

            <div>
              <label for="tooth">Tooth / Site</label>
              <input id="tooth" name="tooth" placeholder="e.g., #8, #19, Full Arch" />
            </div>
            <div>
              <label for="restorationType">Restoration Type</label>
              <select id="restorationType" name="restorationType" required>
                <option value="">Select…</option>
                <option>Single Unit Implant Crown</option>
                <option>Implant Bridge</option>
                <option>Full Arch (All-on-X)</option>
                <option>Crown</option>
                <option>Bridge</option>
                <option>Other</option>
              </select>
            </div>

            <div>
              <label for="material">Material</label>
              <select id="material" name="material">
                <option value="">Select…</option>
                <option>Zirconia</option>
                <option>PFM</option>
                <option>E.max</option>
                <option>Ti Base + Zirconia</option>
                <option>Hybrid</option>
                <option>Other</option>
              </select>
            </div>

            <div>
              <label for="implantSystem">Implant System (if applicable)</label>
              <input id="implantSystem" name="implantSystem" placeholder="Nobel, Straumann, BioHorizons, etc." />
            </div>

            <div style="grid-column: 1 / -1;">
              <label for="notes">Rx Notes / Instructions</label>
              <textarea id="notes" name="notes" placeholder="Shade, occlusion notes, emergence profile goals, screw access, etc."></textarea>
            </div>

            <div style="grid-column: 1 / -1;">
              <label for="files">Upload Files (Prototype)</label>
              <input id="files" name="files" type="file" multiple />
              <div class="hint">For now, this page will NOT upload files anywhere (free prototype). Next we’ll connect secure storage.</div>
            </div>
          </div>

          <div class="actions">
            <button type="submit">Submit Case (Prototype)</button>
            <button type="button" class="secondary" id="downloadBtn">Download Rx Summary</button>
          </div>

          <div class="success" id="successBox">Submitted (prototype). Your summary was prepared successfully.</div>
          <div class="error" id="errorBox">Something went wrong. Please try again.</div>

          <div class="note">
            Current behavior: on submit, we generate a text summary and open your email client to send it to
            <code>cases@wielgotech.com</code>. Files are not uploaded yet (we’ll wire that up next).
          </div>
        </form>
      </div>

      <footer>© <span id="year"></span> Wielgo Tech</footer>
    </div>

    <script>
      document.getElementById("year").textContent = new Date().getFullYear();

      function buildSummary(data) {
        return [
          "WIELGO TECH — DIGITAL CASE SUBMISSION (PROTOTYPE)",
          "----------------------------------------------",
          `Doctor: ${data.doctorName || ""}`,
          `Office: ${data.officeName || ""}`,
          `Email: ${data.email || ""}`,
          `Phone: ${data.phone || ""}`,
          "",
          `Patient Name: ${data.patientName || ""}`,
          `Due Date: ${data.dueDate || ""}`,
          `Tooth/Site: ${data.tooth || ""}`,
          `Restoration Type: ${data.restorationType || ""}`,
          `Material: ${data.material || ""}`,
          `Implant System: ${data.implantSystem || ""}`,
          "",
          "Notes:",
          data.notes || "",
          "",
          "Files selected (not uploaded in this prototype):",
          ...(data.fileNames.length ? data.fileNames.map(n => `- ${n}`) : ["(none)"]),
          "",
          "Next step: connect secure upload + storage before public launch."
        ].join("\n");
      }

      function downloadText(filename, text) {
        const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(a.href);
      }

      const form = document.getElementById("caseForm");
      const successBox = document.getElementById("successBox");
      const errorBox = document.getElementById("errorBox");

      document.getElementById("downloadBtn").addEventListener("click", () => {
        const fd = new FormData(form);
        const files = document.getElementById("files").files;
        const summary = buildSummary({
          doctorName: fd.get("doctorName"),
          officeName: fd.get("officeName"),
          email: fd.get("email"),
          phone: fd.get("phone"),
          patientName: fd.get("patientName"),
          dueDate: fd.get("dueDate"),
          tooth: fd.get("tooth"),
          restorationType: fd.get("restorationType"),
          material: fd.get("material"),
          implantSystem: fd.get("implantSystem"),
          notes: fd.get("notes"),
          fileNames: Array.from(files || []).map(f => f.name),
        });

        downloadText("wielgotech-case-summary.txt", summary);
      });

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        successBox.style.display = "none";
        errorBox.style.display = "none";

        try {
          const fd = new FormData(form);
          const files = document.getElementById("files").files;

          const payload = {
            doctorName: fd.get("doctorName"),
            officeName: fd.get("officeName"),
            email: fd.get("email"),
            phone: fd.get("phone"),
            patientName: fd.get("patientName"),
            dueDate: fd.get("dueDate"),
            tooth: fd.get("tooth"),
            restorationType: fd.get("restorationType"),
            material: fd.get("material"),
            implantSystem: fd.get("implantSystem"),
            notes: fd.get("notes"),
            fileNames: Array.from(files || []).map(f => f.name),
          };

          const summary = buildSummary(payload);

          // Open the user's email client with the summary.
          const subject = encodeURIComponent("New Digital Case - Wielgo Tech (Prototype)");
          const body = encodeURIComponent(summary);
          window.location.href = `mailto:cases@wielgotech.com?subject=${subject}&body=${body}`;

          successBox.style.display = "block";
        } catch (err) {
          errorBox.style.display = "block";
        }
      });
    </script>
  </body>
</html>
